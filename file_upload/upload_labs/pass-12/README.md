# Pass-12 %00 Cut Off Bypass

## 0x00 Lab Overview 

This lab is maily about to bypass file extension check by %00 cut off.

## 0x01 Source Code

```php
$is_upload = false;
$msg = null;
if(isset($_POST['submit'])){
    $ext_arr = array('jpg','png','gif');
    $file_ext = substr($_FILES['upload_file']['name'],strrpos($_FILES['upload_file']['name'],".")+1);
    if(in_array($file_ext,$ext_arr)){
        $temp_file = $_FILES['upload_file']['tmp_name'];
        $img_path = $_POST['save_path']."/".rand(10, 99).date("YmdHis").".".$file_ext;

        if(move_uploaded_file($temp_file,$img_path)){
            $is_upload = true;
        }
        else{
            $msg = "上传失败";
        }
    }
    else{
        $msg = "只允许上传.jpg|.png|.gif类型文件！";
    }
}
```

## 0x02 Go Hack It

### Prepare a Webshell

Follow the instruction [here](../../image_webshell).

![](./test.jpg)

### Catch the Package

As the request is POST, need to add 00 in HEX editor view.

![](./imgs/name.jpg)

Successfully uploaded and can check here to see result.

![](./imgs/upload.jpg)

