# Open Lab 5 Webshell Upload

## 0x00 Basic Knowledge

Need webshell to connect to the server.

## 0x01 Go Hack It

Lab site from [zkaq.org][1]

### [Home Page][2]

![](./imgs/home.jpg)

### Admin Site

Change cookie to the one we get [from Open Lab 4](../../xss/labo4_stored_xss)

![](./imgs/cookie.jpg)

```
ASPSESSIONIDSCACATRD=KGBJKAECOFOOLEHLCKLNDNKC;ADMINSESSIONIDCSTRCSDQ=LBMLMBCCNPFINOANFGLPCFBC
```

Refresh and get into admin site.

![](./imgs/admin.jpg)

### Upload

The webshell is prepared as the [instruction](../image_webshell).

![](./test_asp.jpg)

There is a admin page to add new product.

![](./imgs/new_product.jpg)

Try upload the image.

![](./imgs/upload.jpg)

And change name to **test.asp**

![](./imgs/change_name.jpg)

```
Content-Disposition: form-data; name="FileName"; filename="test.asp"
```

There is a whitelist error showing up.

![](./imgs/whitelist.jpg)

### Change File Extension

Change to CER

![](./imgs/cer.jpg)

Upload success to the [server][3].

![](./imgs/success.jpg)

### FLAG

Connect the uploaded file via **caidao**.

![](./imgs/flag.jpg)

**FLAG** = **zkz{G3t_the_admin!Sh3ll}**

[1]: https://hack.zkaq.org/?a=battle&f=target&id=a82434ce969f8d43
[2]: http://120.203.13.75:8002/admin/default.asp
[3]: http://120.203.13.75:8002/UploadFiles/201934182842996.cer
